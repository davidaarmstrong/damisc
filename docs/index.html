<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dave Armstrong's Miscellaneous Functions • DAMisc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Dave Armstrong's Miscellaneous Functions">
<meta property="og:description" content="Miscellaneous set of functions I use in my teaching either at the University of Western Ontario or the Inter-university Consortium for Political and Social Research (ICPSR) Summer Program in Quantitative Methods.  Broadly, the functions help with presentation and interpretation of LMs and GLMs, but also implement some new tools like Alternating Least Squares Optimal Scaling for dependent variables, a Bayesian analog to the ALSOS algorithm.  There are also tools to help understand interactions in both LMs and binary GLMs. ">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">DAMisc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="damisc-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#damisc-" class="anchor"></a>DAMisc <img src="https://quantoid.net/files/images/damsticker.png" align="right" alt="" width="200">
</h1></div>
<p>The <code>DAMisc</code> package has evolved over the past decade to include many of the functions I use when teaching applied stats to social scientists. I think many of the functions might be useful more broadly so I thought it would be worth discussing the functionality in a sort of thematic way here. The functions do fall into a few different thems.</p>
<ul>
<li>Functions that attempt to figure out whether and what kind of unmodeled non-linearities exist.<br>
</li>
<li>Functions for investigating interactions in different settings (linear models and binomial GLMs).<br>
</li>
<li>Functions for post-model evaluation and examination of non-linear models (GLMs, ordinal data models and unordered data models).</li>
<li>Functions for both frequentist and Bayesian Alternating Least Squares Optimal Scaling (ALSOS).</li>
</ul>
<p>I’ll talk about each of these below.</p>
<div id="evaluating-un-modeled-non-linearities" class="section level3">
<h3 class="hasAnchor">
<a href="#evaluating-un-modeled-non-linearities" class="anchor"></a>Evaluating Un-modeled Non-linearities.</h3>
<p>One of the problems I find most interesting in applied regression analysis is evaluating the extent to which the linear, additive functional form is sufficient to capture the systematic dependence of the outcome on the explanatory variables. For the purposes of this example, we’ll use data from the <code>carData</code> package. Here’s a multiple linear regression model where all covariates enter the model linearly and additively.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(Prestige, <span class="dt">package=</span><span class="st">'carData'</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>lin.mod &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(prestige <span class="op">~</span><span class="st"> </span>income <span class="op">+</span><span class="st"> </span>education <span class="op">+</span><span class="st"> </span>women <span class="op">+</span><span class="st"> </span>type, <span class="dt">data=</span>Prestige)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(lin.mod)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">#&gt; </span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">#&gt; Call:</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#&gt; lm(formula = prestige ~ income + education + women + type, data = Prestige)</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#&gt; </span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">#&gt; -14.7485  -4.4817   0.3119   5.2478  18.4978 </span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#&gt; </span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">#&gt; (Intercept) -0.8139032  5.3311558  -0.153 0.878994    </span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">#&gt; income       0.0010428  0.0002623   3.976 0.000139 ***</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co">#&gt; education    3.6623557  0.6458300   5.671 1.63e-07 ***</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">#&gt; women        0.0064434  0.0303781   0.212 0.832494    </span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">#&gt; typeprof     5.9051970  3.9377001   1.500 0.137127    </span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co">#&gt; typewc      -2.9170720  2.6653961  -1.094 0.276626    </span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co">#&gt; ---</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="co">#&gt; </span></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="co">#&gt; Residual standard error: 7.132 on 92 degrees of freedom</span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="co">#&gt;   (4 observations deleted due to missingness)</span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="co">#&gt; Multiple R-squared:  0.8349, Adjusted R-squared:  0.826 </span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="co">#&gt; F-statistic: 93.07 on 5 and 92 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>We might wonder whether any of the variables have non-linear trends that are not captured by the model. We could use the <code>crPlots</code> function from the <code>car</code> package to figure this out.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>car<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/car/man/crPlots.html">crPlots</a></span>(lin.mod, <span class="dt">layout=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-3-1.png" width="800px" height="800px" style="display: block; margin: auto;"></p>
<p>There certainly appears to be non-linearity in the relationships between <code>income</code> and <code>prestige</code> as well as between <code>women</code> and <code>prestige</code>. If we wonder whether that is statistically significant, we could use the <code>crTest</code> function from the <code>DAMisc</code> package to test the significance of the difference between the OLS and local polynomial regressions in the C+R plots.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(DAMisc)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw"><a href="reference/crTest.html">crTest</a></span>(lin.mod)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt;              RSSp   RSSnp DFnum DFdenom     F     p</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt; income    4678.99 4093.63 1.903  94.097 7.069 0.002</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#&gt; education 4678.99 4656.86 0.946  95.054 0.478 0.481</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#&gt; women     4678.99 4483.03 0.869  95.131 4.785 0.036</span></span></code></pre></div>
<p>Here, the test suggests that the <code>income</code> and <code>women</code> relationships both have significant non-linear relationships with <code>prestige</code>. The next thing to figure out is what that non-linearity looks like. We could use the <code>boxTidwell</code> function from the <code>car</code> package to estimate the transformation parameter for <code>income</code>. There is also a <code>crSpanTest</code> function that looks at the same test as above, but over the reasonable range of the span parameter in the local polynomial regression.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>car<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/car/man/boxTidwell.html">boxTidwell</a></span>(prestige <span class="op">~</span><span class="st"> </span>income, <span class="op">~</span><span class="st"> </span>women <span class="op">+</span><span class="st"> </span>type <span class="op">+</span><span class="st"> </span>education, <span class="dt">data=</span>Prestige)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#&gt;  MLE of lambda Score Statistic (z)  Pr(&gt;|z|)    </span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt;       -0.29939             -4.4858 7.265e-06 ***</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt; ---</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">#&gt; </span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">#&gt; iterations =  7</span></span></code></pre></div>
<p>Here, the MLE of <span class="math inline"><em>λ</em></span>, the transformation parameter, is -0.299. We might wonder whether that’s close enough to the log transform, which is what is used for the 0 power transform. We could figure that out by imposing the transformation in the <code>boxTidwell</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>car<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/car/man/boxTidwell.html">boxTidwell</a></span>(prestige <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(income), <span class="op">~</span><span class="st"> </span>women <span class="op">+</span><span class="st"> </span>type <span class="op">+</span><span class="st"> </span>education, <span class="dt">data=</span>Prestige)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt;  MLE of lambda Score Statistic (z) Pr(&gt;|z|)</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt;        -1.5441             -1.4096   0.1587</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt; </span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt; iterations =  4</span></span></code></pre></div>
<p>Since the proposed additional transformation parameter is not significant, we can be confident that the log transform is sufficient. The <code>women</code> variable likely needs a polynomial since the non-linearity is not simple and monotone. We could use a second degree polynomial, but the <code>NKnots</code> and <code>NKnotsTest</code> functions can help figure this out. Let’s look at the <code>NKnots</code> function first.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="reference/NKnots.html">NKnots</a></span>(prestige <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(income) <span class="op">+</span><span class="st"> </span>type <span class="op">+</span><span class="st"> </span>education, <span class="dt">var=</span><span class="st">"women"</span>, </span>
<span id="cb6-2"><a href="#cb6-2"></a>       <span class="dt">data=</span>Prestige, <span class="dt">degree=</span><span class="dv">3</span>, <span class="dt">includePoly =</span> <span class="ot">TRUE</span>, <span class="dt">plot=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-7-1.png" width="400px" height="400px" style="display: block; margin: auto;"></p>
<p>The <code>NKnots</code> function calculates the AIC for the first up to <code>degree</code> polynomials and the b-splines with 1:(DF - <code>degree</code>) internal knots. The AIC is plotted, and in this case it is clear that the second-order polynomial generates the smallest AIC value. To see whether these differences are significant, we can use the <code>NKnotsTest</code> function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">width=</span><span class="dv">100</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw"><a href="reference/NKnotsTest.html">NKnotsTest</a></span>(prestige <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(income) <span class="op">+</span><span class="st"> </span>type <span class="op">+</span><span class="st"> </span>education, <span class="dt">var=</span><span class="st">"women"</span>, </span>
<span id="cb7-3"><a href="#cb7-3"></a>       <span class="dt">data=</span>Prestige, <span class="dt">degree=</span><span class="dv">3</span>, <span class="dt">target=</span><span class="dv">2</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt;                F      DF1 DF2 p(F)  Clarke Pr(Better) p(Clarke) Delta_AIC Delta_AICc Delta_BIC</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt; DF=2 vs. DF=1  4.348* 1   91  0.040 41     0.418      0.129     2.574     2.201      -0.011   </span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt;    Target                                                                                     </span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt; DF=2 vs. DF=3  0.208  1   90  0.650 77*    0.786      0.000 (T) 1.774     2.202      4.359    </span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">#&gt; DF=2 vs. DF=4  0.200  2   89  0.819 79*    0.806      0.000 (T) 3.561     4.472      8.731    </span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co">#&gt; DF=2 vs. DF=5  0.371  3   88  0.774 82*    0.837      0.000 (T) 4.769     6.221      12.524   </span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">#&gt; DF=2 vs. DF=6  0.266  4   87  0.899 88*    0.898      0.000 (T) 6.807     8.860      17.147   </span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co">#&gt; DF=2 vs. DF=7  0.337  5   86  0.889 83*    0.847      0.000 (T) 8.096     10.812     21.021   </span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co">#&gt; DF=2 vs. DF=8  0.755  6   85  0.607 76*    0.776      0.000 (T) 6.912     10.354     22.422   </span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">#&gt; DF=2 vs. DF=9  1.037  7   84  0.411 80*    0.816      0.000 (T) 5.874     10.109     23.968   </span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">#&gt; DF=2 vs. DF=10 0.808  8   83  0.597 85*    0.867      0.000 (T) 8.649     13.747     29.329   </span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">#&gt; DF=2 vs. DF=11 0.898  9   82  0.531 79*    0.806      0.000 (T) 8.791     14.823     32.055   </span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">#&gt; DF=2 vs. DF=12 0.800  10  81  0.629 83*    0.847      0.000 (T) 10.774    17.814     36.624   </span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="co">#&gt; DF=2 vs. DF=13 0.656  11  80  0.775 85*    0.867      0.000 (T) 13.531    21.657     41.966</span></span></code></pre></div>
<p>In the <code>NKnotsTest</code> function, you have to specify a <code>target</code> which is the degrees of freedom of the proposed model. In this case, we pick <code>2</code>. All smaller and bigger models up to the specified degrees of freedom are tested. If using the <span class="math inline"><em>F</em></span>-test, the idea is that all smaller models should be significantly worse (i.e., have small p-values) and all bigger models should not be significantly better (i.e., have big p-values). We can see that this is true, looking at the <code>p(F)</code> column. You could also use the Clarke test, which is implemented with the <code>clarke_test</code> function from the <a href="https://github.com/davidaarmstrong/ClarkeTest"><code>clarkeTest</code></a> package, which I also built and maintain, or AIC, AIC with a small-sample correction or BIC. The logic of using these other measures is basically the same.</p>
<p>Now that we are confident about the correct (additive) functional form of the variables, we could go on and interpret them as we usually would (or make an effect plot).</p>
</div>
<div id="evaluating-interactions" class="section level3">
<h3 class="hasAnchor">
<a href="#evaluating-interactions" class="anchor"></a>Evaluating Interactions</h3>
<p>Lots has been written recently in Political Science regarding interactions, in both linear and non-linear (generally binomial GLM) models. First, we’ll tackle linear model interactions.</p>
<div id="linear-model-interactions" class="section level4">
<h4 class="hasAnchor">
<a href="#linear-model-interactions" class="anchor"></a>Linear Model Interactions</h4>
<p>We can add an interaction to the model. Here, we can use the same data as above, though we’ll use the linear, conditional specification. There are two main functions that work in linear models - one for evaluating interactions between quantitative and qualitiative variables and one for evaluating interactions between two quantitative variables. Let’s look at the quantitative-qualitative interaction first.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>Prestige<span class="op">$</span>income &lt;-<span class="st"> </span>Prestige<span class="op">$</span>income<span class="op">/</span><span class="dv">1000</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>int.mod1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(prestige <span class="op">~</span><span class="st"> </span>education <span class="op">+</span><span class="st"> </span>income<span class="op">*</span>type <span class="op">+</span><span class="st"> </span>women, <span class="dt">data=</span>Prestige)</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(int.mod1)</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#&gt; </span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt; Call:</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt; lm(formula = prestige ~ education + income * type + women, data = Prestige)</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt; </span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt; -12.632  -4.518   1.057   3.850  18.171 </span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co">#&gt; </span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">#&gt; (Intercept)     -10.07694    5.01000  -2.011   0.0473 *  </span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co">#&gt; education         2.80361    0.59233   4.733 8.18e-06 ***</span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co">#&gt; income            3.85495    0.58655   6.572 3.15e-09 ***</span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co">#&gt; typeprof         27.54962    5.40962   5.093 1.93e-06 ***</span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="co">#&gt; typewc            3.43457    5.36630   0.640   0.5238    </span></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co">#&gt; women             0.07648    0.03117   2.453   0.0161 *  </span></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">#&gt; income:typeprof  -3.00851    0.57540  -5.229 1.10e-06 ***</span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co">#&gt; income:typewc    -1.09486    0.86374  -1.268   0.2082    </span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co">#&gt; ---</span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="co">#&gt; </span></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="co">#&gt; Residual standard error: 6.284 on 90 degrees of freedom</span></span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="co">#&gt;   (4 observations deleted due to missingness)</span></span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="co">#&gt; Multiple R-squared:  0.8746, Adjusted R-squared:  0.8649 </span></span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co">#&gt; F-statistic:  89.7 on 7 and 90 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>We can make sure that the interaction is significant with the <code>Anova</code> function from the <code>car</code> package:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>car<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span>(int.mod1)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt; </span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt; Response: prestige</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&gt;             Sum Sq Df F value    Pr(&gt;F)    </span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt; education    884.6  1 22.4026 8.176e-06 ***</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt; income       803.9  1 20.3606 1.932e-05 ***</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt; type         583.1  2  7.3837  0.001073 ** </span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt; women        237.7  1  6.0197  0.016074 *  </span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt; income:type 1125.4  2 14.2514 4.199e-06 ***</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt; Residuals   3553.6 90                      </span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>We see that the interaction is significant. We can use the <code>intQualQuant</code> function from the <code>DAMisc</code> package to figure out what the interaction implies. First, let’s calculate the simple slopes:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw"><a href="reference/intQualQuant.html">intQualQuant</a></span>(int.mod1, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"income"</span>, <span class="st">"type"</span>), <span class="dt">type=</span><span class="st">"slopes"</span>, <span class="dt">plot=</span><span class="ot">FALSE</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">#&gt; Conditional Effect of  income  given  type </span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co">#&gt;         eff     se  tstat pvalue</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#&gt; bc   3.8550 0.5865 6.5723  0.000</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">#&gt; prof 0.8464 0.2340 3.6170  0.000</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt; wc   2.7601 0.8255 3.3436  0.001</span></span></code></pre></div>
<p>Here, we see that the slope of income (in thousands of dollars) on prestige is 3.86 for blue collar occupations, 2.76 for white collar occupations and only 0.85 for professional occupations. We could also make a plot of the three different lines holding constant all other variables.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw"><a href="reference/intQualQuant.html">intQualQuant</a></span>(int.mod1, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"income"</span>, <span class="st">"type"</span>), <span class="dt">type=</span><span class="st">"slopes"</span>, <span class="dt">plot=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-12-1.png" width="400px" height="400px" style="display: block; margin: auto;"></p>
<p>One of the benefits of this function is that it plots a rug for the quantitative variable at each level of the qualitative variable. This indicates, particularly in this case, that the density of income depends very much on occupation type. The other side of the interaction is also important. We can plot that side of the interaction by specifying <code>type='facs'</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>lattice<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lattice/man/trellis.par.get.html">trellis.par.set</a></span>(<span class="dt">strip.background=</span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">col=</span><span class="st">"gray75"</span>))</span>
<span id="cb12-2"><a href="#cb12-2"></a>out &lt;-<span class="st"> </span><span class="kw"><a href="reference/intQualQuant.html">intQualQuant</a></span>(int.mod1, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"income"</span>, <span class="st">"type"</span>), <span class="dt">type=</span><span class="st">"facs"</span>, <span class="dt">plot=</span><span class="ot">TRUE</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(out, <span class="dt">layout=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">3</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-13-1.png" width="900px" height="300px" style="display: block; margin: auto;"></p>
<p>This shows the effect of moving from every level to every other level in the qualitative variable for all values of the quantitative variable. Here, the rug plots at the bottom help identify ranges of the quantitative variable where inference is safe.</p>
<p>Next, we can look at interactions between two quantitative variables.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>int.mod2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(prestige <span class="op">~</span><span class="st"> </span>income<span class="op">*</span>education <span class="op">+</span><span class="st"> </span>type <span class="op">+</span><span class="st"> </span>women, <span class="dt">data=</span>Prestige)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(int.mod2)</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt; </span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&gt; Call:</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt; lm(formula = prestige ~ income * education + type + women, data = Prestige)</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">#&gt; </span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">#&gt; -15.2186  -5.0131   0.6606   4.8713  16.9888 </span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">#&gt; </span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co">#&gt;                   Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co">#&gt; (Intercept)      -21.53038    8.09938  -2.658  0.00928 ** </span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co">#&gt; income             4.37994    1.04769   4.181 6.68e-05 ***</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co">#&gt; education          5.25108    0.78217   6.713 1.59e-09 ***</span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="co">#&gt; typeprof           4.57575    3.76607   1.215  0.22751    </span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co">#&gt; typewc            -4.81161    2.59942  -1.851  0.06741 .  </span></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="co">#&gt; women              0.03947    0.03059   1.290  0.20019    </span></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co">#&gt; income:education  -0.24147    0.07363  -3.280  0.00147 ** </span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co">#&gt; ---</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co">#&gt; </span></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co">#&gt; Residual standard error: 6.781 on 91 degrees of freedom</span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="co">#&gt;   (4 observations deleted due to missingness)</span></span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="co">#&gt; Multiple R-squared:  0.8524, Adjusted R-squared:  0.8427 </span></span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="co">#&gt; F-statistic: 87.58 on 6 and 91 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>There are a couple of different things we can do here. The most recent advice comes from Berry, Golder and Milton’s 2012 piece in the <em>Journal of Politics</em>. First, suggested making conditional effects plots. The <code>DAintfun2</code> function in the <code>DAMisc</code> package does this for you.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw"><a href="reference/DAintfun2.html">DAintfun2</a></span>(int.mod2, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"income"</span>, <span class="st">"education"</span>), <span class="dt">hist=</span><span class="ot">TRUE</span>, </span>
<span id="cb14-2"><a href="#cb14-2"></a>          <span class="dt">scale.hist=</span>.<span class="dv">3</span>)</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-15-1.png" width="900px" height="450px" style="display: block; margin: auto;"></p>
<p>Here, the conditional effect of one variable is plotted on the <span class="math inline"><em>y</em></span>-axis and the conditioning variable is plotted on the <span class="math inline"><em>x</em></span>-axis. The histogram gives the density of the conditioning variable. The <code>scale.hist</code> argument determines vertically how much of the plotting region the histogram occupies. The axis numbers on the right-hand side belong to the histogram and the ones on the left belong to the conditional effect. There are two other visualizations that might be useful in other circumstances. The first, produced with <code>DAintfun3</code> provides the conditional effect of one variable at the mean and the mean<span class="math inline">±</span>SD of the other variable. Here’s what that looks like in this case.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw"><a href="reference/DAintfun3.html">DAintfun3</a></span>(int.mod2, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"income"</span>, <span class="st">"education"</span>))</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-16-1.png" width="900px" height="450px" style="display: block; margin: auto;"></p>
<p>The third method, with <code>DAintfun</code> produces a single 3-D surface plot where the areas of higher bivariate density are shaded in lighter colors.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw"><a href="reference/DAintfun.html">DAintfun</a></span>(int.mod2,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"income"</span>, <span class="st">"education"</span>), <span class="dt">theta=</span><span class="op">-</span><span class="dv">45</span>, <span class="dt">ticktype=</span><span class="st">"detail"</span>, <span class="dt">phi=</span><span class="dv">15</span>)</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-17-1.png" width="450px" height="450px" style="display: block; margin: auto;"></p>
<p>Finally, there are two more functions that can be used here. The <code>changeSig</code> function calculates where conditional effects change from significant to insignificant. Here’s an example using the model above.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw"><a href="reference/changeSig.html">changeSig</a></span>(int.mod2, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"income"</span>, <span class="st">"education"</span>))</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">#&gt; LB for B(income | education) = 0 when education=15.7712 (97th pctile)</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co">#&gt; UB for B(income | education) = 0 when education=25.5111 (&gt; Maximum Value in Data)</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">#&gt; LB for B(education | income) = 0 when income=14.6971 (96th pctile)</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co">#&gt; UB for B(education | income) = 0 when income=46.3725 (&gt; Maximum Value in Data)</span></span></code></pre></div>
<p>This function shows when the lower and upper confidence bounds cross zero and what percentile of the conditioning variable’s distribution that is.</p>
<p>Finally, following Berry, Golder and Milton (2012), the function <code>BGMtest</code> tests all of the hypotheses they specify.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw"><a href="reference/BGMtest.html">BGMtest</a></span>(int.mod2, <span class="dt">vars=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"income"</span>, <span class="st">"education"</span>))</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">#&gt;              est    se      t p-value</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">#&gt; P(X|Zmin)  2.839 0.602  4.717 0.000  </span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">#&gt; P(X|Zmax)  0.524 0.295  1.773 0.080  </span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">#&gt; P(Z|Xmin)  4.851 0.713  6.803 0.000  </span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co">#&gt; P(Z|Xmax) -0.998 1.548 -0.645 0.521  </span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co">#&gt; P(XZ)     -0.241 0.074 -3.280 0.001</span></span></code></pre></div>
</div>
<div id="non-linear-model-interactions" class="section level4">
<h4 class="hasAnchor">
<a href="#non-linear-model-interactions" class="anchor"></a>Non-linear Model Interactions</h4>
<p>The work on interactions has a long history. Until quite recently, the work by Ai, Norton and Wang was the most prominent in this area. In recent years, political scientists - Bill Berry, Jacqueline DeMeritt, Justin Esarey and Carlisle Rainey have all made contributions here.</p>
<p>There are two related questions:</p>
<ol>
<li>Is a product term necessary for an interaction to exist?</li>
<li>How to test for an interaction?</li>
</ol>
<p>Rainey’s answer to the first problem is compelling. He argues that unless there is strong theory to suggest that the product term is <em>not</em> necessary, then it should be included. The counterintuitive part of the argument is that rather than the product term enhancing our ability to find an interaction, the product term actually can mitigate the effect of compression reducing the strength of the interaction if the data is consistent with a more additive process.</p>
<p>The <code>DAMisc</code> package has two functions that can help. The <code>intEff</code> function is a more or less direct port of the code that Norton, Wang and Ai proposed in their article in the Stata Journal. I prefer the <code>secondDiff</code> function that directly calculates second differences and uses a parametric bootstrap to find confidence intervals for the calculated quantities. We will demonstrate with the <code>conflictData</code> from the <code>clarkeTest</code> package.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(conflictData, <span class="dt">package=</span><span class="st">"clarkeTest"</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>conflictData<span class="op">$</span>rgdpna_pc &lt;-<span class="st"> </span>conflictData<span class="op">$</span>rgdpna_pc<span class="op">/</span><span class="dv">1000</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>bin.mod1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(conflict_binary <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(pop) <span class="op">+</span><span class="st"> </span>rgdpna_pc <span class="op">+</span><span class="st">  </span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="st">                 </span>polity2, <span class="dt">data=</span>conflictData, </span>
<span id="cb19-5"><a href="#cb19-5"></a>               <span class="dt">family=</span>binomial)</span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a>bin.mod2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(conflict_binary <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(pop) <span class="op">+</span><span class="st"> </span>rgdpna_pc <span class="op">*</span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="st">                 </span>polity2, <span class="dt">data=</span>conflictData, </span>
<span id="cb19-9"><a href="#cb19-9"></a>               <span class="dt">family=</span>binomial)</span></code></pre></div>
<p>In the models above, <code>bin.mod1</code> has the terms linearly and additively entered in the model. <code>bin.mod2</code> includes a product term between <code>rgdpna_pc</code> and <code>polity2</code>. We could test to see whether the second model fits better than the first.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span>(bin.mod1, bin.mod2, <span class="dt">test=</span><span class="st">'Chisq'</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co">#&gt; </span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co">#&gt; Model 1: conflict_binary ~ log(pop) + rgdpna_pc + polity2</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co">#&gt; Model 2: conflict_binary ~ log(pop) + rgdpna_pc * polity2</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co">#&gt; 1      4377     3969.2                     </span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co">#&gt; 2      4376     3968.5  1  0.68458    0.408</span></span></code></pre></div>
<p>The <span class="math inline"><em>χ</em><sup>2</sup></span> in the analysis of deviance test would suggest that both models fit pretty much the same. Thus, there may not be a reason to prefer the product term model. Now, however, we could use the <code>secondDiff</code> function to figure out whether there is a significant conditional effect (independent of whether the product term is in the model). The <code>secondDiff</code> function, by default, uses the average marginal effect approach to calculating the difference. Here it is for the model without the product term.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>sd1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/secondDiff.html">secondDiff</a></span>(bin.mod1, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rgdpna_pc"</span>, <span class="st">"polity2"</span>), conflictData)</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(sd1)</span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co">#&gt; Second Difference Using the Average Marginal Effect Approach</span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co">#&gt; </span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="co">#&gt; Overall: </span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="co">#&gt; Average Second Difference: 0.049, 95% CI: (0.001,0.097)</span></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="co">#&gt; </span></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="co">#&gt; Individual:</span></span>
<span id="cb21-9"><a href="#cb21-9"></a><span class="co">#&gt; Significant Negative Individual Second Differences: 0 </span></span>
<span id="cb21-10"><a href="#cb21-10"></a><span class="co">#&gt; Significant Positive Individual Second Differences: 4381 </span></span>
<span id="cb21-11"><a href="#cb21-11"></a><span class="co">#&gt; Inignificant Individual Second Differences: 0</span></span></code></pre></div>
<p>Here all of the second differences are positive. The average second difference is 0.049, meaning that the difference in probability of conflict is .05 bigger for a change in GDP when democracy is high than when democracy is low. We could plot out all of the individual confidence intervals as well.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(sd1))</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-23-1.png" width="400px" height="400px" style="display: block; margin: auto;"></p>
<p>Now we could do the same thing for the model with the product term</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>sd2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/secondDiff.html">secondDiff</a></span>(bin.mod2, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rgdpna_pc"</span>, <span class="st">"polity2"</span>), conflictData)</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(sd2)</span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">#&gt; Second Difference Using the Average Marginal Effect Approach</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co">#&gt; </span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co">#&gt; Overall: </span></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co">#&gt; Average Second Difference: 0.065, 95% CI: (0.000,0.127)</span></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co">#&gt; </span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="co">#&gt; Individual:</span></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co">#&gt; Significant Negative Individual Second Differences: 0 </span></span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="co">#&gt; Significant Positive Individual Second Differences: 4307 </span></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="co">#&gt; Inignificant Individual Second Differences: 74</span></span></code></pre></div>
<p>Note here, that some of the individual second differences are insignificant, but overall, the picture looks pretty similar - the average second differences is 0.065 (slightly bigger than before) and significantly different from zero. In this case, including the product term doesn’t actually change what we think about the interaction much at all.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(sd2))</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-25-1.png" width="400px" height="400px" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="non-linear-model-post-estimation-tools" class="section level3">
<h3 class="hasAnchor">
<a href="#non-linear-model-post-estimation-tools" class="anchor"></a>Non-linear Model Post-Estimation Tools</h3>
<p>Probably the largest group of functions in the <code>DAMisc</code> package are for post-estimation evaluation of non-linear models - particularly binomial (and to a lesser degree, poisson) GLMs and models for ordered and unordered categorical dependent variables. We’ll talk about each kind in turn.</p>
<div id="binomial-glms" class="section level4">
<h4 class="hasAnchor">
<a href="#binomial-glms" class="anchor"></a>Binomial GLMs</h4>
<p>Using the model discussed above, we can test out the tools for binomial GLMs. Just to remind, we’ll use the following:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(conflictData, <span class="dt">package=</span><span class="st">"clarkeTest"</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a>conflictData<span class="op">$</span>rgdpna_pc &lt;-<span class="st"> </span>conflictData<span class="op">$</span>rgdpna_pc<span class="op">/</span><span class="dv">1000</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>bin.mod1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(conflict_binary <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(pop) <span class="op">+</span><span class="st"> </span>rgdpna_pc <span class="op">+</span><span class="st">  </span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="st">                 </span>polity2, <span class="dt">data=</span>conflictData, </span>
<span id="cb25-5"><a href="#cb25-5"></a>               <span class="dt">family=</span>binomial)</span></code></pre></div>
<p>One of the first things we can do is to figure out how well the model fits. We can do this with the <code>binfit</code> function:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw"><a href="reference/binfit.html">binfit</a></span>(bin.mod1)</span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co">#&gt;                    Names1     vals1                       Names2     vals2</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co">#&gt; 1 Log-Lik Intercept Only: -2322.451          Log-Lik Full Model: -1984.578</span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co">#&gt; 2                D(4377):  3969.157                       LR(3):   675.745</span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co">#&gt; 3                                                     Prob &gt; LR:     0.000</span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co">#&gt; 4          McFadden's R2:     0.145           McFadden's Adk R2:     0.144</span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co">#&gt; 5      ML (Cox-Snell) R2:     0.143 Cragg-Uhler (Nagelkerke) R2:     0.219</span></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co">#&gt; 6  McKelvey &amp; Zavoina R2:     0.390                  Efron's R2:     0.145</span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="co">#&gt; 7               Count R2:     0.783                Adj Count R2:     0.026</span></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co">#&gt; 8                    BIC:  4002.697                         AIC:  3977.157</span></span></code></pre></div>
<p>This function produces a bunch of scalar measures of fit for binary models. If you are unfamiliar with some of these, see Long (1997) or Long and Freese (2005) for a discussion. You can also use the <code>pre</code> function to find the proportional reduction in error and the expected proportional reduction in error (Herron, 1999).</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw"><a href="reference/pre.html">pre</a></span>(bin.mod1)</span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="co">#&gt; mod1:  conflict_binary ~ log(pop) + rgdpna_pc + polity2 </span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="co">#&gt; mod2:  conflict_binary ~ 1 </span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="co">#&gt; </span></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="co">#&gt; Analytical Results</span></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="co">#&gt;  PMC =  0.777 </span></span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="co">#&gt;  PCP =  0.783 </span></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="co">#&gt;  PRE =  0.026 </span></span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="co">#&gt; ePMC =  0.654 </span></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="co">#&gt; ePCP =  0.705 </span></span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="co">#&gt; ePRE =  0.148</span></span></code></pre></div>
<p>By default, the <code>pre</code> function tests the current model relative to the null model. However, you can also use it to evaluate two differently specified models against each other. The <code>sim</code> argument allows you to produce parametric bootstrap confidence intervals for the PRE and ePRE.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw"><a href="reference/pre.html">pre</a></span>(bin.mod1, <span class="dt">sim=</span><span class="ot">TRUE</span>, <span class="dt">R=</span><span class="dv">1500</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="co">#&gt; mod1:  conflict_binary ~ log(pop) + rgdpna_pc + polity2 </span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co">#&gt; mod2:  conflict_binary ~ 1 </span></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="co">#&gt; </span></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="co">#&gt; Analytical Results</span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="co">#&gt;  PMC =  0.777 </span></span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="co">#&gt;  PCP =  0.783 </span></span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="co">#&gt;  PRE =  0.026 </span></span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="co">#&gt; ePMC =  0.654 </span></span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="co">#&gt; ePCP =  0.705 </span></span>
<span id="cb28-11"><a href="#cb28-11"></a><span class="co">#&gt; ePRE =  0.148 </span></span>
<span id="cb28-12"><a href="#cb28-12"></a><span class="co">#&gt; </span></span>
<span id="cb28-13"><a href="#cb28-13"></a><span class="co">#&gt; Simulated Results</span></span>
<span id="cb28-14"><a href="#cb28-14"></a><span class="co">#&gt;      median lower upper</span></span>
<span id="cb28-15"><a href="#cb28-15"></a><span class="co">#&gt;  PRE 0.027  0.009 0.058</span></span>
<span id="cb28-16"><a href="#cb28-16"></a><span class="co">#&gt; ePRE 0.147  0.123 0.172</span></span></code></pre></div>
<p>The <code>glmChange</code> function uses the marginal effects at reasonable values approach to calculating the change in predicted probability for a change in each explanatory variable.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw"><a href="reference/glmChange.html">glmChange</a></span>(bin.mod1, <span class="dt">data=</span>conflictData, <span class="dt">diffchange=</span><span class="st">"sd"</span>, <span class="dt">sim=</span><span class="ot">TRUE</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="co">#&gt; $diffs</span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="co">#&gt;                  min       max        diff       lower        upper</span></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="co">#&gt; pop       0.03179818 0.4568626  0.42506441  0.39457088  0.456223985</span></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="co">#&gt; rgdpna_pc 0.28088911 0.1332726 -0.14761653 -0.17635944 -0.118870924</span></span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="co">#&gt; polity2   0.21777594 0.2024958 -0.01528019 -0.03889378  0.009492247</span></span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="co">#&gt; </span></span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="co">#&gt; $minmax</span></span>
<span id="cb29-9"><a href="#cb29-9"></a><span class="co">#&gt;              pop  rgdpna_pc    polity2</span></span>
<span id="cb29-10"><a href="#cb29-10"></a><span class="co">#&gt; typical 10311.00  6.2824424  3.0000000</span></span>
<span id="cb29-11"><a href="#cb29-11"></a><span class="co">#&gt; min       250.00  0.1615948 -0.6042397</span></span>
<span id="cb29-12"><a href="#cb29-12"></a><span class="co">#&gt; max     79969.46 14.9960241  6.6042397</span></span>
<span id="cb29-13"><a href="#cb29-13"></a><span class="co">#&gt; </span></span>
<span id="cb29-14"><a href="#cb29-14"></a><span class="co">#&gt; attr(,"class")</span></span>
<span id="cb29-15"><a href="#cb29-15"></a><span class="co">#&gt; [1] "change"</span></span></code></pre></div>
<p>What we see above is that the effect of changing population by a standard deviation (from 250 to 79969.46), hodling <code>rgdpna_pc</code> constant at 6.28 and <code>polity2</code> constant at 3, is to make conflict more likely by 0.425. That difference is statistically significant.</p>
<p>For those who would rather have the average marginal effect approach, the <code>glmChange2</code> function has you covered. Here, because of the computational complexity, the function only does one variable at a time. The result for population is below:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw"><a href="reference/glmChange2.html">glmChange2</a></span>(bin.mod1, <span class="st">"pop"</span>, conflictData, <span class="st">"sd"</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="co">#&gt;          mean     lower     upper</span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="co">#&gt; pop 0.3581361 0.3299457 0.3869225</span></span></code></pre></div>
<p>Here, we can see that the effect is attenuated slightly. Changing population by a standard deviation for each individual observation produces an average effect of 0.358, which is also significantly bigger than zero.</p>
<p>Finally, the <code>probci</code> function also calculates the difference in predicted probabilities for any combination of values. For example, here’s what it looks like for <code>rgdpna_pc</code> and <code>polity2</code>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw"><a href="reference/probci.html">probci</a></span>(bin.mod1, conflictData, <span class="dt">changeX=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rgdpna_pc"</span>, <span class="st">"polity2"</span>), </span>
<span id="cb31-2"><a href="#cb31-2"></a>       <span class="dt">numQuantVals=</span><span class="dv">2</span>)</span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co">#&gt;   rgdpna_pc1 polity21 rgdpna_pc2 polity22 pred_prob   lower   upper</span></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="co">#&gt; 1     0.1616      -10   155.9892      -10   -0.3490 -0.3779 -0.3212</span></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="co">#&gt; 2     0.1616      -10     0.1616       10   -0.0486 -0.0965  0.0000</span></span>
<span id="cb31-6"><a href="#cb31-6"></a><span class="co">#&gt; 3     0.1616      -10   155.9892       10   -0.3490 -0.3779 -0.3212</span></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="co">#&gt; 4   155.9892      -10     0.1616       10    0.3005  0.2670  0.3365</span></span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="co">#&gt; 5   155.9892      -10   155.9892       10   -0.0000 -0.0001  0.0000</span></span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="co">#&gt; 6     0.1616       10   155.9892       10   -0.3005 -0.3365 -0.2671</span></span></code></pre></div>
<p>Here, we’re choosing 2 values of both variables. The first two columns show the values of the two variables we change from and the second two columns show the values we are changing to. The <code>pred_prob</code> column gives the difference in probabilities moving from the first set of values to the second. The <code>lower</code> and <code>upper</code> are the confidence bounds for the difference in probabilities.</p>
<p>Just like finding predicted probabilities, it’s also easy to plot the predicted probabilities using the <code>effects</code> package or the <code>DAMisc</code> package. The <code>effects</code> packages uses the marginal effects at reasonable values approach.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(effects)</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span>(<span class="st">"rgdpna_pc"</span>, bin.mod1, <span class="dt">xlevels=</span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">rgdpna_pc =</span> <span class="dv">100</span>)), </span>
<span id="cb32-3"><a href="#cb32-3"></a>     <span class="dt">type=</span><span class="st">"response"</span>)</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-33-1.png" width="400px" height="400px" style="display: block; margin: auto;"></p>
<p>The <code>aveEffPlot</code> function in the <code>DAMisc</code> package uses the average marginal effects approach to make the same graph.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw"><a href="reference/aveEffPlot.html">aveEffPlot</a></span>(bin.mod1, <span class="st">"rgdpna_pc"</span>, conflictData, </span>
<span id="cb33-2"><a href="#cb33-2"></a>           <span class="dt">nvals=</span><span class="dv">50</span>)</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-34-1.png" width="400px" height="400px" style="display: block; margin: auto;"></p>
<p>If you don’t like the lattice plot, you can specify <code>plot=FALSE</code> and the data will be returned.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>outDat &lt;-<span class="st"> </span><span class="kw"><a href="reference/aveEffPlot.html">aveEffPlot</a></span>(bin.mod1, <span class="st">"rgdpna_pc"</span>, conflictData, </span>
<span id="cb34-2"><a href="#cb34-2"></a>           <span class="dt">nvals=</span><span class="dv">25</span>, <span class="dt">plot=</span><span class="ot">FALSE</span>)</span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(outDat)</span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="co">#&gt; [1] "s"     "mean"  "lower" "upper"</span></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(outDat) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-7"><a href="#cb34-7"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>s, <span class="dt">ymin=</span>lower, <span class="dt">ymax=</span>upper), <span class="dt">col=</span><span class="st">"gray75"</span>, <span class="dt">alpha=</span>.<span class="dv">5</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>s, <span class="dt">y=</span>mean)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-9"><a href="#cb34-9"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-10"><a href="#cb34-10"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x=</span><span class="st">"GDP/capita"</span>, <span class="dt">y=</span><span class="st">"Predicted Probability"</span>)</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-35-1.png" width="400px" height="400px" style="display: block; margin: auto;"></p>
<p>As for testing, the <code>testNL</code> function allows you to test whether non-linear transformations or polynomials would be better using the <code>clarke_test</code> function. Below, I test to see whether the log of <code>rgdpna_pc</code> or a cubic polynomial would be better than the original model.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw"><a href="reference/testNL.html">testNL</a></span>(bin.mod1, <span class="st">"rgdpna_pc"</span>, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="co">#&gt;            Model1          Model2  pval       preferred</span></span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="co">#&gt; 1        Original Power Transform 0.000 Power Transform</span></span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="co">#&gt; 2        Original      Polynomial 0.002        Original</span></span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="co">#&gt; 3 Power Transform      Polynomial 0.000 Power Transform</span></span></code></pre></div>
<p>In the above, the power transform is significanly better than the original, the original is better than the polynomial model and the power transform is better than the polynomial. This means we should use the power transform in our model.</p>
</div>
<div id="ordinal-dependent-variable-models" class="section level4">
<h4 class="hasAnchor">
<a href="#ordinal-dependent-variable-models" class="anchor"></a>Ordinal Dependent Variable Models</h4>
<p>The functions that evaluate and interrogate models for ordinal dependent can use both <code>polr</code> (<code>MASS</code> package).</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(conflictData, <span class="dt">package=</span><span class="st">"clarkeTest"</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a>conflictData<span class="op">$</span>Amnesty &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(conflictData<span class="op">$</span>Amnesty)</span>
<span id="cb36-3"><a href="#cb36-3"></a></span>
<span id="cb36-4"><a href="#cb36-4"></a>ol1 &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/MASS/man/polr.html">polr</a></span>(Amnesty <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(rgdpna_pc) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(pop) <span class="op">+</span><span class="st"> </span>polity2, </span>
<span id="cb36-5"><a href="#cb36-5"></a>                  <span class="dt">data=</span>conflictData)</span></code></pre></div>
<p>The <code>ordfit</code> function generates measures of fit for ordinal DV models:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw"><a href="reference/ordfit.html">ordfit</a></span>(ol1)</span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="co">#&gt;                       Estimate</span></span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="co">#&gt; Count R2              0.408   </span></span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="co">#&gt; Count R2 (Adj)        0.133   </span></span>
<span id="cb37-5"><a href="#cb37-5"></a><span class="co">#&gt; ML R2                 0.284   </span></span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="co">#&gt; McFadden R2           0.113   </span></span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="co">#&gt; McFadden R2 (Adj)     0.112   </span></span>
<span id="cb37-8"><a href="#cb37-8"></a><span class="co">#&gt; McKelvey &amp; Zavoina R2 0.288</span></span></code></pre></div>
<p>The <code>pre</code> function also works for these models:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw"><a href="reference/pre.html">pre</a></span>(ol1)</span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="co">#&gt; mod1:  Amnesty ~ log(rgdpna_pc) + log(pop) + polity2 </span></span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="co">#&gt; mod2:  Amnesty ~ 1 </span></span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="co">#&gt; </span></span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="co">#&gt; Analytical Results</span></span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="co">#&gt;  PMC =  0.317 </span></span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="co">#&gt;  PCP =  0.408 </span></span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="co">#&gt;  PRE =  0.133 </span></span>
<span id="cb38-9"><a href="#cb38-9"></a><span class="co">#&gt; ePMC =  0.250 </span></span>
<span id="cb38-10"><a href="#cb38-10"></a><span class="co">#&gt; ePCP =  0.308 </span></span>
<span id="cb38-11"><a href="#cb38-11"></a><span class="co">#&gt; ePRE =  0.077</span></span></code></pre></div>
<p>The <code>ordChange</code> and <code>ordChange2</code> functions are the analogs of <code>glmChange</code> and <code>glmChange2</code> from above.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(oc1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/ordChange.html">ordChange</a></span>(ol1, <span class="dt">data=</span>conflictData, <span class="dt">diffchange=</span><span class="st">"sd"</span>, <span class="dt">sim=</span><span class="ot">TRUE</span>))</span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="co">#&gt;           1       2       3       4       5      </span></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="co">#&gt; rgdpna_pc  0.160*  0.305* -0.046  -0.252* -0.167*</span></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="co">#&gt; pop       -0.361* -0.175   0.253*  0.201*  0.082*</span></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="co">#&gt; polity2    0.059*  0.071  -0.057  -0.053* -0.020*</span></span></code></pre></div>
<p>You can also print the result of this as well:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>lattice<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lattice/man/trellis.par.get.html">trellis.par.set</a></span>(<span class="dt">strip.background=</span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">col=</span><span class="st">"gray75"</span>))</span>
<span id="cb40-2"><a href="#cb40-2"></a>out &lt;-<span class="st"> </span><span class="kw"><a href="reference/oc2plot.html">oc2plot</a></span>(oc1)</span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(out, <span class="dt">layout=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">3</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-41-1.png" width="900px" height="300px" style="display: block; margin: auto;"></p>
<p>This shows how the indicated change in the variable changes the probability of being in each group. You can also use the AME approach with ordChange2.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(oc2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/ordChange2.html">ordChange2</a></span>(ol1, <span class="st">"rgdpna_pc"</span>, <span class="dt">data=</span>conflictData, <span class="dt">diffchange=</span><span class="st">"sd"</span>))</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="co">#&gt;           1       2       3       4       5      </span></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="co">#&gt; rgdpna_pc  0.107*  0.167   0.004  -0.134* -0.143*</span></span></code></pre></div>
<p>Also, just like above, the <code>ordAveEffPlot</code> does something similar to the <code>effects</code> package, but using the AME approach.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>op1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/ordAveEffPlot.html">ordAveEffPlot</a></span>(ol1, <span class="st">"rgdpna_pc"</span>, conflictData, </span>
<span id="cb42-2"><a href="#cb42-2"></a>           <span class="dt">nvals=</span><span class="dv">25</span>)</span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(op1, <span class="dt">layout=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-43-1.png" width="1000px" height="200px" style="display: block; margin: auto;"></p>
</div>
<div id="unordered-dependent-variable-models" class="section level4">
<h4 class="hasAnchor">
<a href="#unordered-dependent-variable-models" class="anchor"></a>Unordered Dependent Variable Models</h4>
<p>We can use the same model specification as above to estimate multinomial models.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(conflictData, <span class="dt">package=</span><span class="st">"clarkeTest"</span>)</span>
<span id="cb43-2"><a href="#cb43-2"></a>conflictData<span class="op">$</span>Amnesty &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(conflictData<span class="op">$</span>Amnesty)</span>
<span id="cb43-3"><a href="#cb43-3"></a></span>
<span id="cb43-4"><a href="#cb43-4"></a>ml1 &lt;-<span class="st"> </span>nnet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/nnet/man/multinom.html">multinom</a></span>(Amnesty <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(rgdpna_pc) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(pop) <span class="op">+</span><span class="st"> </span>polity2, </span>
<span id="cb43-5"><a href="#cb43-5"></a>                  <span class="dt">data=</span>conflictData)</span>
<span id="cb43-6"><a href="#cb43-6"></a><span class="co">#&gt; # weights:  25 (16 variable)</span></span>
<span id="cb43-7"><a href="#cb43-7"></a><span class="co">#&gt; initial  value 7050.947494 </span></span>
<span id="cb43-8"><a href="#cb43-8"></a><span class="co">#&gt; iter  10 value 6003.430441</span></span>
<span id="cb43-9"><a href="#cb43-9"></a><span class="co">#&gt; iter  20 value 5533.285659</span></span>
<span id="cb43-10"><a href="#cb43-10"></a><span class="co">#&gt; final  value 5532.122608 </span></span>
<span id="cb43-11"><a href="#cb43-11"></a><span class="co">#&gt; converged</span></span></code></pre></div>
<p>The original model summary function isn’t all that useful because it prints the coefficient matrix separate from a matrix of standard errors. The <code>mnlSig</code> function prints a more useful summary:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw"><a href="reference/mnlSig.html">mnlSig</a></span>(ml1)</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="co">#&gt;   (Intercept) log(rgdpna_pc) log(pop) polity2</span></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="co">#&gt; 2      7.757*        -0.828*   0.177* -0.134*</span></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="co">#&gt; 3      7.246*        -1.131*   0.521* -0.186*</span></span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="co">#&gt; 4      3.350*        -1.255*   0.960* -0.198*</span></span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="co">#&gt; 5      5.081*        -1.416*   0.826* -0.197*</span></span></code></pre></div>
<p>The <code>mnlfit</code> function produces scalar measures of fit for the model:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw"><a href="reference/mnlfit.html">mnlfit</a></span>(ml1)</span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="co">#&gt; $result</span></span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="co">#&gt;                                Estimate      p-value</span></span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="co">#&gt; Fagerland, Hosmer and Bonfi 379.2187628 5.503904e-61</span></span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="co">#&gt; Count R2                      0.4462451           NA</span></span>
<span id="cb45-6"><a href="#cb45-6"></a><span class="co">#&gt; Count R2 (Adj)                0.1891711           NA</span></span>
<span id="cb45-7"><a href="#cb45-7"></a><span class="co">#&gt; ML R2                         0.3498981           NA</span></span>
<span id="cb45-8"><a href="#cb45-8"></a><span class="co">#&gt; McFadden R2                   0.1456721           NA</span></span>
<span id="cb45-9"><a href="#cb45-9"></a><span class="co">#&gt; McFadden R2 (Adj)             0.1424291           NA</span></span>
<span id="cb45-10"><a href="#cb45-10"></a><span class="co">#&gt; Cragg-Uhler(Nagelkerke) R2    0.3690984           NA</span></span>
<span id="cb45-11"><a href="#cb45-11"></a><span class="co">#&gt; </span></span>
<span id="cb45-12"><a href="#cb45-12"></a><span class="co">#&gt; attr(,"class")</span></span>
<span id="cb45-13"><a href="#cb45-13"></a><span class="co">#&gt; [1] "mnlfit"</span></span></code></pre></div>
<p>The <code>pre</code> function also works:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw"><a href="reference/pre.html">pre</a></span>(ml1)</span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="co">#&gt; mod1:  Amnesty ~ log(rgdpna_pc) + log(pop) + polity2 </span></span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="co">#&gt; mod2:  Amnesty ~ 1 </span></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="co">#&gt; </span></span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="co">#&gt; Analytical Results</span></span>
<span id="cb46-6"><a href="#cb46-6"></a><span class="co">#&gt;  PMC =  0.317 </span></span>
<span id="cb46-7"><a href="#cb46-7"></a><span class="co">#&gt;  PCP =  0.446 </span></span>
<span id="cb46-8"><a href="#cb46-8"></a><span class="co">#&gt;  PRE =  0.189 </span></span>
<span id="cb46-9"><a href="#cb46-9"></a><span class="co">#&gt; ePMC =  0.250 </span></span>
<span id="cb46-10"><a href="#cb46-10"></a><span class="co">#&gt; ePCP =  0.328 </span></span>
<span id="cb46-11"><a href="#cb46-11"></a><span class="co">#&gt; ePRE =  0.105</span></span></code></pre></div>
<p>The <code>mnlChange</code> and <code>mnlChange2</code> functions work the same as the <code>ordChnge</code> and <code>ordChange2</code> functions and have the same print method and can be used with the <code>oc2plot</code> function just as above.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="reference/mnlChange.html">mnlChange</a></span>(ml1, conflictData, <span class="dt">diffchange=</span><span class="st">"sd"</span>))</span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="co">#&gt;           1       2       3       4       5      </span></span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="co">#&gt; rgdpna_pc  0.152*  0.271* -0.125* -0.151* -0.147*</span></span>
<span id="cb47-4"><a href="#cb47-4"></a><span class="co">#&gt; pop       -0.185* -0.422*  0.196*  0.318*  0.093*</span></span>
<span id="cb47-5"><a href="#cb47-5"></a><span class="co">#&gt; polity2    0.080*  0.056* -0.079* -0.041* -0.016*</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="reference/mnlChange2.html">mnlChange2</a></span>(ml1, <span class="st">"rgdpna_pc"</span>, conflictData, <span class="dt">diffchange=</span><span class="st">"sd"</span>))</span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="co">#&gt;           1       2       3       4       5      </span></span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="co">#&gt; rgdpna_pc  0.119*  0.132* -0.071* -0.088* -0.090*</span></span></code></pre></div>
<p>The <code>ordAveEffPlot</code> function works here as well just as it did above.</p>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Ai, Chunrong and Edward C. Norton. 2003. Interaction Terms in Logit and Probit Models. Economics Letters 80(1): 123-129.</p>
<p>Berry, W.D., DeMeritt, J.H.R. and Esarey, J. (2010) “Testing for Interaction in Binary Logit and Probit Models: Is a Product Term Essential?” <em>American Journal of Political Science</em> 54: 248-266.</p>
<p>Berry, W., DeMeritt, J., &amp; Esarey, J. (2016). “Bias and Overconfidence in Parametric Models of Interactive Processes” <em>American Journal of Political Science</em> 60(2): 521-539.</p>
<p>Berry, William D., Matt Golder and Daniel Milton. (2012) “Improving Tests of Theories Positing Interaction” <em>The Journal of Politics</em> 74(3): 653-671.</p>
<p>Herron, M. 1999. “Postestimation Uncertainty in Limited Dependent Variable Models” <em>Political Analysis</em> 8(1): 83–98.</p>
<p>Long, J.S. 1997. Regression Models for Categorical and Limited Dependent Variables. Thousand Oaks, CA: Sage.</p>
<p>Long, J.S. and J. Freese. 2005. Regression Models for Categorical Outcomes Using Stata, 2nd ed. College Station, TX: Stata Press.</p>
<p>Norton, Edward C., Hua Wang and Chunrong Ai. 2004. Computing Interaction Effects and Standard Errors in Logit and Probit Models. The Stata Journal 4(2): 154-167.</p>
<p>Rainey, Carlisle. 2016. “Compression and Conditional Effects: A Product Term Is Essential When Using Logistic Regression to Test for Interaction.” <em>Political Science Research and Methods</em> 4(3): 621-639.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=DAMisc">https://​cloud.r-project.org/​package=DAMisc</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;=2)</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Dave Armstrong <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Dave Armstrong.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
